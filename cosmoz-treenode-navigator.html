<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../paper-item/paper-item.html"> 
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../iron-list/iron-list.html">
<link rel="import" href="../cosmoz-i18next/cosmoz-i18next.html">

<!--
Navigator through object with treelike datastructure.

@demo demo/index.html
-->

<dom-module id="cosmoz-treenode-navigator">
	<template>
		<style is="custom-style" include="iron-flex iron-flex-alignment">

			#header {
				margin: 0 16px;
			}

			#header a {
				text-decoration: none;
				color: inherit;
			}

			.section {
				background-color: #f5f5f5;
				padding: 5px;
			}
			
			.nodeItem {
				cursor:pointer
			}
			
			.listTree {
				max-width: 540px;
				max-height: var(--cosmoz-treenode-navigator-max-height, 70vh);
				overflow-y: auto;
			}

			.slash {
				margin: 0 2px;
			}

			iron-list {
				max-height: 50vh;
			}
		</style>
		<div id="header">
			<h3 class="layout horizontal center wrap">
				<a href="#" data-path="" on-click="openNode"><iron-icon icon="home"></iron-icon></a>
				<template is="dom-repeat" items="[[ _openNodeLevelPathParts ]]" as="node">
					<span class="slash">/</span><a href="#" data-path$="[[ node.path ]]" on-click="openNode">[[ getNodeName(node) ]]</a>
				</template>
			</h3>
			<paper-input class="flex" label="[[ searchPlaceholder ]]" title$="[[ searchPlaceholder ]]"
				id="searchInput" value="{{ inputValue }}">
				<a suffix hidden$="[[ !_searching ]]" href="#" on-tap="clearSearch"><iron-icon icon="clear"></iron-icon></a>
			</paper-input>
		</div>
		<iron-list items="[[dataPlane]]" as="node">
			<template>
				<div>
					<div class="section" hidden$="[[ !_renderSection(_searching, index, dataPlane, node) ]]">[[ node.sectionName ]]</div>
					<paper-item on-tap="_nodeSelected" location-path="[[ node.path ]]" class="nodeItem" node-object="[[ node ]]">
						<span class="flex">[[ node.name ]]</span>
						<iron-icon hidden$="[[ !hasChildren(node) ]]" icon="icons:arrow-forward" on-click="openNode" data-path$="[[ node.path ]]"></iron-icon>
					</paper-item>
				</div>
			</template>
		</iron-list>
		<paper-button hidden$="[[ !showGlobalSearch(_searching, _openNodeLevelPath) ]]" on-click="tryGlobalSearch">[[ localSearchDoneText ]]</paper-button>
	</template>
	<script type="text/javascript" src="cosmoz-treenode-navigator.js"></script>
</dom-module>